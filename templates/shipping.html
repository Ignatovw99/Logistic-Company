{% extends 'base.html' %}
{% include 'header.html' %}



{% block title %} Shipments {% endblock %}



{% block body %}

<div class="container">
    <div class="row">
        <div class="col md-12">

            <div class="jumbotron p-3">

                <h2>Manage <b>Shipments</b>  <button type="button"  class="btn btn-success float-right"
                data-toggle="modal" data-target="#mymodal">Add New Shipment</button> </h2>


                {% with messages = get_flashed_messages() %}

                {% if messages %}

                {% for message in messages %}

                <div class="alert alert-success alert-dismissable" role="alert">

                    <button type="button" class="close" data-dismiss="alert" aria-label="close">

                        <span aria-hidden="true">x</span>

                    </button>


                {{message}}


                </div>


                {% endfor %}

                {% endif %}
                {% endwith %}


                <table class="table table-hover table-dark">

                    <tr>

                        <th>ID</th>
                        <th>Weight</th>
                        <th>Status</th>
                        <th>From</th>
                        <th>To</th>
                        <th>Sender</th>
                        <th>Receiver</th>
                        <th>Acceptor</th>
                        <th>Deliverer</th>
                        <th>Action</th>

                    </tr>


                   {% for row in shipments %}


                    <tr>
                        <td>{{row.id}}</td>
                        <td>{{row.weight}}</td>
                        <td>{{row.status}}</td>
                        <td>{{row.from_address_id}}</td>
                        <td>{{row.to_address_id}}</td>
                        <td>{{row.sender}}</td>
                        <td>{{row.receiver}}</td>
                        <td>{{row.acceptor}}</td>
                        <td>{{row.deliverer}}</td>


                        <td>
                            <a href="/update/{{row.id}}" class="btn btn-warning btn-xs" data-toggle="modal" data-target="#modaledit{{row.id}}">Edit</a>
                            <a href="/shipping/delete/{{row.id}}" class="btn btn-danger btn-xs"  >Delete</a>


                        </td>

                    </tr>


                  <!-- Modal Edit Employee-->
<div id="modaledit{{row.id}}" class="modal fade" role="dialog">
   <div class="modal-dialog">


      <div class="modal-content">


         <div class="modal-header">


            <h4 class="modal-title">Update Information</h4>


         </div>


         <div class="modal-body">


            <form action="{{url_for('update_shipping')}}" method="POST">


               <div class="form-group">

                  <label>Weight:</label>
                   <input type="hidden"  name="id" value="{{row.id}}">
                  <input type="number" class="form-control" name="weight" value="{{row.weight}}">

               </div>



                <div class="form-group">
                  <label>Status:</label>
                    <select  name="status" value="1">

                        <option value='1'> SHIPPED</option>
                        <option value='2'> DELIVERED</option>


                    </select>

               </div>

                <div class="form-group">

                  <label>From:</label>

                <input type="radio" id="from_office" name="optionsFrom" value="office" onClick="javascript:return checkedFunction('from_office')" checked>
                          <label for="from_office">Office</label>
                  <input type="radio" id="from_address" name="optionsFrom" value="address" onClick="javascript:return checkedFunction('from_address')" checked>
                          <label for="from_address">Address</label>

                  <script type="text/javascript">
                           function checkedFunction(radio_id)
                            {
                              if(radio_id == "from_office")
                              {
   	                              document.getElementById('select_from_office').style.display = 'block';
                                  document.getElementById('from_address_text').style.display = 'none';

                               }
                               else if(radio_id == "from_address")
                              {
	                              document.getElementById('select_from_office').style.display = 'none';
	                              document.getElementById('from_address_text').style.display = '';
                              }

                              }

                    </script>

                    <input id="from_address_text" type="text" class="form-control" name="fromAddressText" value="{{ row.from_address_id }}" >
                <div id="select_from_office" style = "display:none" >
                    <select  name="selectFromOffice" value="{{ row.from_address_id }}">
                         {% for row in offices %}
                        <option value={{row.id}}> {{row.id}}, {{row.address}} </option>
                        {% endfor %}

                    </select>
                </div>


               </div>



               <div class="form-group">


                  <label>To:</label>

                    <input type="radio" id="to_office" name="optionsTo" value="office" onClick="javascript:return checkedToFunction('to_office')" checked>
                          <label for="from_office">Office</label>
                  <input type="radio" id="to_address" name="optionsTo" value="address" onClick="javascript:return checkedToFunction('to_address')" checked>
                          <label for="from_address">Address</label>


                        <script type="text/javascript">
                           function checkedToFunction(radio_id)
                            {
                              if(radio_id == 'to_office')
                              {
   	                              document.getElementById('select_to_office').style.display = 'block';
                                  document.getElementById('to_address_text').style.display = 'none';

                               }
                               else if(radio_id == 'to_address')
                              {
	                              document.getElementById('select_to_office').style.display = 'none';
	                              document.getElementById('to_address_text').style.display = '';
                              }

                              }

                    </script>

                    <input id="to_address_text" type="text" class="form-control" name="toAddressText" value="{{ row.to_address_id }}">

                    <div id="select_to_office" style = "display:none">
                    <select  name="selectToOffice" value = "{{ row.to_address_id }}">
                         {% for row in offices %}
                        <option value={{row.id}}> {{row.id}}, {{row.address}} </option>
                        {% endfor %}

                    </select>
                    </div>




               </div>


               <div class="form-group">


                  <label>Sender:</label>

                  <input type="number" class="form-control" name="sender" value="{{row.sender.id}}">


               </div>

                <div class="form-group">


                  <label>Receiver:</label>

                  <input type="number" class="form-control" name="receiver" value="{{row.receiver.id}}">


               </div>



                <div class="form-group">


                  <label>Acceptor:</label>

                  <input type="number" class="form-control" name="acceptor" value="{{row.acceptor.id}}">


               </div>

                <div class="form-group">


                  <label>Deliverer:</label>

                  <input type="number" class="form-control" name="deliverer" value="{{row.deliverer.id}}">


               </div>



               <div class="form-group">


                  <button class="btn btn-primary" type="submit">Update</button>


               </div>


            </form>


         </div>


         <div class="modal-footer">


            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>


         </div>


      </div>


   </div>

</div>


                    {% endfor %}


                </table>


            </div>






<div id="mymodal" class="modal fade" role="dialog">
   <div class="modal-dialog">
      <div class="modal-content">
         <div class="modal-header">

            <h4 class="modal-title">Add Shipment</h4>
         </div>
         <div class="modal-body">

            <form action="{{url_for('insert_shipping')}}" method="POST">


               <div class="form-group">

                  <label>Weight:</label>
                  <input type="number" class="form-control" name="weight" required="1">


               </div>

                <div class="form-group">

                  <label>Status</label>
                  <select  name="status" required="1">

                        <option value=1> SHIPPED </option>
                        <option value=2> DELIVERED</option>

                    </select>


               </div>
                <div class="form-group">

                  <label>From:</label>
                  <input type="radio" id="from_office" name="optionsFrom" value="office" onClick="javascript:return checkedFunction('from_office')" checked>
                          <label for="from_office">Office</label>
                  <input type="radio" id="from_address" name="optionsFrom" value="address" onClick="javascript:return checkedFunction('from_address')" checked>
                          <label for="from_address">Address</label>

                  <script type="text/javascript">
                           function checkedFunction(radio_id)
                            {
                              if(radio_id == "from_office")
                              {
   	                              document.getElementById('select_from_office').style.display = 'block';
                                  document.getElementById('from_address_text').style.display = 'none';

                               }
                               else if(radio_id == "from_address")
                              {
	                              document.getElementById('select_from_office').style.display = 'none';
	                              document.getElementById('from_address_text').style.display = '';
                              }

                              }

                    </script>

                    <input id="from_address_text" type="text" class="form-control" name="fromAddressText"  value="city, complex,street"
                           onfocus="(this.value == 'city, complex,street') && (this.value = '')"
                           onblur="(this.value == '') && (this.value = 'city, complex,street')"
                           required="1">

                    <div id="select_from_office"  style="display: none" required="1" >

                      <select  name="selectFromOffice" >
                           {% for selectFromOffice in offices %}
                          <option value={{selectFromOffice.id}}> {{selectFromOffice.id}}, {{selectFromOffice.address}} </option>
                          {% endfor %}

                      </select>

                    </div>




               </div>


                <div class="form-group">


                  <label>To:</label>
                  <input type="radio" id="to_office" name="optionsTo" value="office" onClick="javascript:return checkedToFunction('to_office')" checked>
                          <label for="from_office">Office</label>
                  <input type="radio" id="to_address" name="optionsTo" value="address" onClick="javascript:return checkedToFunction('to_address')" checked>
                          <label for="from_address">Address</label>


                        <script type="text/javascript">
                           function checkedToFunction(radio_id)
                            {
                              if(radio_id == 'to_office')
                              {
   	                              document.getElementById('select_to_office').style.display = 'block';
                                  document.getElementById('to_address_text').style.display = 'none';

                               }
                               else if(radio_id == 'to_address')
                              {
	                              document.getElementById('select_to_office').style.display = 'none';
	                              document.getElementById('to_address_text').style.display = '';
                              }

                              }

                    </script>

                    <input id="to_address_text" type="text" class="form-control" name="toAddressText" value="city, complex,street"
                           onfocus="(this.value == 'city, complex,street') && (this.value = '')"
                           onblur="(this.value == '') && (this.value = 'city, complex,street')"
                           required="1">

                    <div id="select_to_office" style = "display:none">
                    <select  name="selectToOffice" required = "1">
                         {% for row in offices %}
                        <option value={{row.id}}> {{row.id}}, {{row.address}} </option>
                        {% endfor %}

                    </select>
                    </div>





               </div>


                <div class="form-group">


                  <label>Sender:</label>
                  <input type="number" class="form-control" name="sender" required="1">


               </div>

                <div class="form-group">


                  <label>Receiver</label>
                  <input type="number" class="form-control" name="receiver" required="1">


               </div>

                <div class="form-group">

                  <label>Acceptor:</label>
                  <input type="number" class="form-control" name="acceptor" required="1">


               </div>
                <div class="form-group">

                  <label>Deliverer:</label>
                  <input type="number" class="form-control" name="deliverer" required="1">


               </div>



               <div class="form-group">


                  <button class="btn btn-primary" type="submit">Add Shipment</button>


               </div>


            </form>


         </div>


         <div class="modal-footer">


            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>


         </div>


      </div>


   </div>


</div>





        </div>

    </div>


</div>


{% endblock %}